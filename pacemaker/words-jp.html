

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>17. 用語説明 &mdash; PacemakerDoc 1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PacemakerDoc 1 documentation" href="index.html"/>
        <link rel="next" title="18. Process of detaching/attaching ClusterIP in case of node/service failure" href="ClusterIP_detach.html"/>
        <link rel="prev" title="16. Code-walk / Monitoring resources" href="codewalk-monitoringResource.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PacemakerDoc
          

          
          </a>

          
            
            
              <div class="version">
                0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pacemaker_setup.html">1. Pacemaker / fencing setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="webui.html">2. PCSD Web UI</a></li>
<li class="toctree-l1"><a class="reference internal" href="cluster-resource.html">3. Cluster Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustered_web.html">4. Setup clustered web servers</a></li>
<li class="toctree-l1"><a class="reference internal" href="fence_test.html">5. Fencing test</a></li>
<li class="toctree-l1"><a class="reference internal" href="fence_case_study.html">6. Fencing case studies</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_active_vip.html">7. Active/Active setup - VIP</a></li>
<li class="toctree-l1"><a class="reference internal" href="corosync_crypto.html">8. Crypt corosync/totem messaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Questions.html">9. Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="refs.html">10. References / links</a></li>
<li class="toctree-l1"><a class="reference internal" href="HA-calc.html">11. Calculations of high availability systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipt_clusterip.html">12. ClusterIP / iptables mechanisms</a></li>
<li class="toctree-l1"><a class="reference internal" href="group-clone.html">13. Clone resources / clone groups</a></li>
<li class="toctree-l1"><a class="reference internal" href="pacemaker-inside.html">14. Pacemaker inside</a></li>
<li class="toctree-l1"><a class="reference internal" href="codewalk-addResource.html">15. Code Walk / Adding resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="codewalk-monitoringResource.html">16. Code-walk / Monitoring resources</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">17. 用語説明</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#cluster-concepts">17.1. Cluster Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cluster">17.1.1. Cluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="#subcluster">17.1.2. Subcluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="#primary-subcluster">17.1.3. Primary Subcluster</a></li>
<li class="toctree-l3"><a class="reference internal" href="#membership">17.1.4. Membership</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determination-of-quorum">17.1.5. Determination of Quorum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fencing">17.1.6. Fencing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#type-of-cluster-ha">17.2. Type of cluster HA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#active-passive">17.2.1. Active/passive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#active-active">17.2.2. Active/active</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#pacemaker-specific">17.3. Pacemaker specific</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#resource-group-clone">17.3.1. Resource, Group, Clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constraint-colocation-order">17.3.2. Constraint, Colocation, Order</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ClusterIP_detach.html">18. Process of detaching/attaching ClusterIP in case of node/service failure</a></li>
<li class="toctree-l1"><a class="reference internal" href="pengine-crmd.html">19. Pengine - crmd</a></li>
<li class="toctree-l1"><a class="reference internal" href="cib-crmd.html">20. cib - crmd</a></li>
<li class="toctree-l1"><a class="reference internal" href="pacemaker-haproxy-setup.html">21. Active/Passive HA proxy using Pacemaker setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="cib.html">22. CIB</a></li>
<li class="toctree-l1"><a class="reference internal" href="mariadb-cluster.html">23. Setting up clustered MariaDB with Pacemaker</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">PacemakerDoc</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>17. 用語説明</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/words-jp.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>17. 用語説明<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cluster-concepts">
<h2>17.1. Cluster Concepts<a class="headerlink" href="#cluster-concepts" title="Permalink to this headline">¶</a></h2>
<p>英語部分は、下記サイトから引用
<a class="reference external" href="http://linux-ha.org/wiki/Cluster_Concepts">http://linux-ha.org/wiki/Cluster_Concepts</a></p>
<div class="section" id="cluster">
<h3>17.1.1. Cluster<a class="headerlink" href="#cluster" title="Permalink to this headline">¶</a></h3>
<p>For our purposes, a cluster is a collection of loosely coupled cooperating computing elements which we refer to as nodes. Failures in clusters are not observed instantaneously or simultaneously by every node. Instead, failures occur asynchronously, and are observed stochastically and independently by the nodes of the cluster. It is not guaranteed that any particular failure will be observed in the same way by every node in the cluster, or even observed at all by every node.</p>
<p>クラスタとは、疎結合している複数のコンピューティングノードの集合です。一般にクラスタ内ノードの動作不良は、確実に把握、共有されることはなく、一部のノードにより確率的に観測されます。（以降のSubcluster, Membership, Quorum, Fencingなどは、この問題を解決するための仕組みと及び概念と位置づけられます。）</p>
</div>
<div class="section" id="subcluster">
<h3>17.1.2. Subcluster<a class="headerlink" href="#subcluster" title="Permalink to this headline">¶</a></h3>
<p>At any given point in time, a cluster is divided into zero or more subclusters (or partitions) of live nodes. Each live node has a view of subcluster membership, and acknowledges membership in no more than one of these subclusters. The most desirable state is that there is only one subcluster in the cluster, and that all (active) nodes belong to that subcluster. However, communication failures can cause a single cluster to divide into multiple subclusters which are partially or completely unaware of each other.</p>
<p>クラスタが動作しているノードの集合からなる部分集合に分割された場合、それぞれの部分集合をSubclusterと呼びます。</p>
</div>
<div class="section" id="primary-subcluster">
<h3>17.1.3. Primary Subcluster<a class="headerlink" href="#primary-subcluster" title="Permalink to this headline">¶</a></h3>
<p>One of these subclusters may be designated the primary subcluster. Traditionally, this primary subcluster is said to have quorum (or more specifically have cluster-quorum, or cluster-wide-quorum). How and why the primary subcluster is chosen is implementation-dependent. How and why each node associates itself with a particular subcluster is implementation-dependent.</p>
<p>quorumの対応する日本語は、定足数となります。クラスターが分割され、相互に情報交換ができない状況で誰がPrimary Subclusterとなるかを判断する方法として、quorum（定足数）を定義し、subclusterのメンバー数がquorum以上であればそのsubclusterをprimary subclusterとします。複数のsubclusterが同時に自分達がprimary subclusterだと信じてシステムの整合性が破壊されること（スプリットブレイン問題）を回避するためにこの仕組みが利用されます。</p>
</div>
<div class="section" id="membership">
<h3>17.1.4. Membership<a class="headerlink" href="#membership" title="Permalink to this headline">¶</a></h3>
<p>Membership calculation is the process whereby each node associates itself with a particular subcluster, and obtains a (probabalistically current) view of subcluster membership. Quorum calculation is the process whereby the primary subcluster (if any) is selected.
Normally, a membership algorithm will try to make the primary subcluster as large as it can, but it is provable that this is impossible under all circumstances. If a node is in a non-primary subcluster, the membership algorithm is under no obligation to try and make these non-primary subclusters as large as possible.
At any given point in time, each node can view the subcluster of which it is a member as either having stable membership or being in transition. Stable membership is defined to mean that no event has yet been observed by the node which would cause it to recalculate subcluster membership and/or quorum. In transition means that a particular node has observed an event which may cause a membership change, but that the process of recomputing membership and/or quorum has not yet completed. Different nodes in a subcluster may have different views of the stable/transition state at any given point in time.
Because failures occur asynchronously and are observed stochastically, membership provides only probabilistic (and not absolute) assurances of ability to communicate with any particular node. Because it is impossible to know whether a node in a subcluster might observed an event which would make it go into a into transition, in a very real sense, membership is only probabilistically certain, never absolutely certain.</p>
<p>Membershipとは、任意のsubclusterに所属しているノードの集合です。Quorumの計算は、Membership（つまり、いくつのノードがそのsubclusterに所属しているか）に基き実施されます。あるsubclusterに属しているノードたちは、それぞれにどのノードがそのsubclusterに属しているのか（Membership)についての情報を計算し保持していますが、それは確率的に恐らくそうであろうという情報であり、確実な情報では有り得ません。</p>
</div>
<div class="section" id="determination-of-quorum">
<h3>17.1.5. Determination of Quorum<a class="headerlink" href="#determination-of-quorum" title="Permalink to this headline">¶</a></h3>
<p>The quorum calculation process is required to select no more than one primary subcluster at a time, but need not select any at all. Under some circumstances, designating more than one primary subcluster at a time can lead to irrecoverable application failures. Nevertheless, no quorum algorithm can provide an absolute guarantee of this property in the presence of arbitrary failures. Different quorum implementations provide different degrees of certainty for any given configuration and set of expected failures.</p>
<p>A common method for defining quorum is to say that a subcluster of size n in a cluster of m total nodes has quorum if it has a plurality of nodes in its partition. That is, it has n members where n &gt; INT(m/2). This simple method works quite well for larger clusters with generally reliable communications. However it breaks down for 2-node clusters, and may perform poorly for geographically dispersed clusters without highly reliable communications between sites.</p>
<p>Quorumの計算目的は、唯一のPrimary subclusterを決定することにあります。
ここでは、例としてquorumをクラスタを構成する全ノードの過半数としているが、Pacemakerでも上記の方式でquorumを定義ています。</p>
</div>
<div class="section" id="fencing">
<h3>17.1.6. Fencing<a class="headerlink" href="#fencing" title="Permalink to this headline">¶</a></h3>
<p>We use the term fencing to refer to the act of separating a cluster node from the resources it manages, without its cooperation. That is, proper fencing techniques will separate a node from its resources without the cooperation of the node being fenced. Given that a cluster node which is subjected to fencing is typically thought to be errant, and the nature of the fault it has experienced is unknown, relying on a third party (involuntary) fencing mechanism increases the probability that an errant node is not longer using its resources. Using fencing and is considered more reliable than simply relying on an errant node to stop using resources on its own.</p>
<p>Pacemakerでは、Fencingと同義語としてしばしはSTONITH(Shoot The Other Node In The Head)が用いられます。問題があるノードをクラスタから切り離すことを指します。上記では、Fencingの信頼性を高めるには、問題のあるノードの助けを借りずに外部からFencingすることが必要であると述べられています。</p>
</div>
</div>
<div class="section" id="type-of-cluster-ha">
<h2>17.2. Type of cluster HA<a class="headerlink" href="#type-of-cluster-ha" title="Permalink to this headline">¶</a></h2>
<p>クラスタで高可用性（HA cluster）を実現する方式として、代表的なもの（Active/active, Active/passive, N+1, N+M, N-to-1, N-to-N）が下記リンクに記載されています。
<a class="reference external" href="https://en.wikipedia.org/wiki/High-availability_cluster">https://en.wikipedia.org/wiki/High-availability_cluster</a></p>
<p>ここでは、試用手順で取り上げた二つの方式について説明します。</p>
<div class="section" id="active-passive">
<h3>17.2.1. Active/passive<a class="headerlink" href="#active-passive" title="Permalink to this headline">¶</a></h3>
<p>プライマリノードとそれを完全に代替できるスタンバイノードで構成します。スタンバイノードは、プライマリノードに問題が生じた時にだけオンラインになります。</p>
</div>
<div class="section" id="active-active">
<h3>17.2.2. Active/active<a class="headerlink" href="#active-active" title="Permalink to this headline">¶</a></h3>
<p>全てのノードが応答可能な状態で稼働します。問題が生じたノードへのトラフィックは、稼働している残りのノードのいずれかにロードバランスされます。</p>
</div>
</div>
<div class="section" id="pacemaker-specific">
<h2>17.3. Pacemaker specific<a class="headerlink" href="#pacemaker-specific" title="Permalink to this headline">¶</a></h2>
<p>以下、Pacemakerで利用される特有の用語についてです。</p>
<div class="section" id="resource-group-clone">
<h3>17.3.1. Resource, Group, Clone<a class="headerlink" href="#resource-group-clone" title="Permalink to this headline">¶</a></h3>
<p>Resourceは、クラスタで提供されるサービスのことを指さします。Resourceの最も基本的なタイプをprimitive resourceと言いますprimitive resourceは対応するresource agent（実体は動作を実装したスクリプト）により動作が規定されます。
より複雑なタイプのresourceとして、group, cloneがあります。複数のresourceの集合をgroupとして扱うことが可能です。また、resourceを複製し、複数のノードで動かすためにcloneが利用されます。</p>
</div>
<div class="section" id="constraint-colocation-order">
<h3>17.3.2. Constraint, Colocation, Order<a class="headerlink" href="#constraint-colocation-order" title="Permalink to this headline">¶</a></h3>
<p>constraintとは、制約のことです。resourceの配置や関係性に制約条件を課すことができ、その条件の集合をconstraintと言います。
colocationは、resource間の関係を記述します。例えば、</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># pcs constraint colocation add webserver with ClusterIP INFINITY</span>
</pre></div>
</div>
<p>とした場合、webserverリソースは、ClusterIPリソースが起動している場所でしか起動することができなくなります。
また、resource間の起動／停止の順序を指定することも可能で、その場合はorderを利用します。</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># pcs constraint order ClusterIP then webserver</span>
</pre></div>
</div>
<p>例えば上記のように指定すると、起動はClusterIP -&gt; webserverの順になり、停止は逆順になります。</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ClusterIP_detach.html" class="btn btn-neutral float-right" title="18. Process of detaching/attaching ClusterIP in case of node/service failure" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="codewalk-monitoringResource.html" class="btn btn-neutral" title="16. Code-walk / Monitoring resources" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 Red Hat, Inc..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>